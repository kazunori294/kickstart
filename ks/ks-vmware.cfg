#kickstart file automatically generated by anaconda.

#version=DEVEL
install
url --url=http://10.1.0.2/centos6
lang en_US.UTF-8
keyboard us
network --onboot yes --device eth0 --bootproto dhcp --noipv6
rootpw  --iscrypted $6$WuOrTh90AnsCTDux$o90yJHujaQfxsy79FSt4JnOC1JSBNjsvsCRQluewJx86VDzW8xvpnqER1jzyGxujZJKa1Q9Fc1awZjszQyEQH1
firewall --disabled
authconfig --enableshadow --passalgo=sha512
selinux --disabled
timezone --utc Asia/Tokyo
bootloader --location=mbr --driveorder=sda --append="crashkernel=auto rhgb quiet"
text
reboot

# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work

zerombr
clearpart --all --initlabel

part /boot --fstype=ext4 --size=500
part pv.008002 --grow --size=1

volgroup vg_centos --pesize=4096 pv.008002
logvol / --fstype=ext4 --name=lv_root --vgname=vg_centos --grow --size=1024 --maxsize=51200
logvol swap --name=lv_swap --vgname=vg_centos --grow --size=2016 --maxsize=4032

#volgroup VolGroup --pesize=4096 pv.008002
#logvol / --fstype=ext4 --name=lv_root --vgname=VolGroup --grow --size=1024 --maxsize=51200
#logvol swap --name=lv_swap --vgname=VolGroup --grow --size=992 --maxsize=992
#part /boot --fstype=ext4 --size=500
#part pv.008002 --grow --size=1


repo --name="CentOS"  --baseurl=http://10.1.0.2/centos6 --cost=100

%packages --nobase
@core


%post
exec < /dev/tty3 > /dev/tty3
chvt 3

yum install -y wget
yum install -y sudo
yum install -y git

mkdir /root/.ssh
wget -O /root/.ssh/id_rsa  https://s3-ap-northeast-1.amazonaws.com/s3testkazutan/id_rsa
chmod 600 /root/.ssh/id_rsa
echo -e "Host github.com\n\tStrictHostKeyChecking no\n" >> /root/.ssh/config

curl -L http://www.opscode.com/chef/install.sh | sudo bash
git clone git@github.com:kazunori294/chef-repo.git /etc/chef-repo

sudo chef-solo -c /etc/chef-repo/solo.rb -j /etc/chef-repo/nodes/init.json

%end
